{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}Edit Profile | X{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto bg-black text-white">
    <!-- Header -->
    <div class="flex items-center p-4 border-b border-gray-800">
        <a href="#" class="mr-8">
            <svg viewBox="0 0 24 24" class="w-5 h-5 text-gray-400 hover:text-blue-400" fill="currentColor">
                <g><path d="M20 11H7.414l4.293-4.293c.39-.39.39-1.023 0-1.414s-1.023-.39-1.414 0l-6 6c-.39.39-.39 1.023 0 1.414l6 6c.195.195.45.293.707.293s.512-.098.707-.293c.39-.39.39-1.023 0-1.414L7.414 13H20c.553 0 1-.447 1-1s-.447-1-1-1z"></path></g>
            </svg>
        </a>
        <div>
            <h1 class="text-xl font-bold">Edit profile</h1>
        </div>
    </div>
    
    <!-- Cover and avatar section -->
    <div class="relative">
        <!-- Cover image preview -->
        <div class="h-48 bg-gray-800 relative">
            <img src="{{ user.profile.cover_image.url }}" alt="Cover" class="w-full h-full object-cover">
            <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity cursor-pointer">
                <label for="id_cover_image" class="cursor-pointer">
                    <div class="p-2 rounded-full bg-black bg-opacity-60">
                        <svg viewBox="0 0 24 24" class="w-6 h-6 text-white" fill="currentColor">
                            <g><path d="M19.708 22H4.292C3.028 22 2 20.972 2 19.708V7.375C2 6.11 3.028 5.083 4.292 5.083h2.146C7.633 3.17 9.722 2 12 2c2.277 0 4.367 1.17 5.562 3.083h2.146C20.972 5.083 22 6.11 22 7.375v12.333C22 20.972 20.972 22 19.708 22zM4.292 6.583c-.437 0-.792.355-.792.792v12.333c0 .437.355.792.792.792h15.416c.437 0 .792-.355.792-.792V7.375c0-.437-.355-.792-.792-.792h-2.45c-.317.05-.632-.095-.782-.382-.88-1.665-2.594-2.7-4.476-2.7-1.883 0-3.598 1.035-4.476 2.702-.16.302-.502.46-.834.38H4.293z M12 8.545c-2.455 0-4.455 2-4.455 4.455s2 4.455 4.455 4.455 4.455-2 4.455-4.455-2-4.455-4.455-4.455zm0 7.41c-1.627 0-2.955-1.328-2.955-2.955s1.328-2.955 2.955-2.955 2.955 1.328 2.955 2.955-1.328 2.955-2.955 2.955z"></path></g>
                        </svg>
                    </div>
                </label>
            </div>
        </div>
        
        <!-- Avatar preview -->
        <div class="absolute left-4 top-32">
            <div class="w-24 h-24 rounded-full border-4 border-black bg-gray-800 overflow-hidden relative">
                <img src="{{ user.profile.avatar.url }}" alt="{{ user.username }}" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity cursor-pointer">
                    <label for="id_avatar" class="cursor-pointer">
                        <div class="p-2 rounded-full bg-black bg-opacity-60">
                            <svg viewBox="0 0 24 24" class="w-5 h-5 text-white" fill="currentColor">
                                <g><path d="M19.708 22H4.292C3.028 22 2 20.972 2 19.708V7.375C2 6.11 3.028 5.083 4.292 5.083h2.146C7.633 3.17 9.722 2 12 2c2.277 0 4.367 1.17 5.562 3.083h2.146C20.972 5.083 22 6.11 22 7.375v12.333C22 20.972 20.972 22 19.708 22zM4.292 6.583c-.437 0-.792.355-.792.792v12.333c0 .437.355.792.792.792h15.416c.437 0 .792-.355.792-.792V7.375c0-.437-.355-.792-.792-.792h-2.45c-.317.05-.632-.095-.782-.382-.88-1.665-2.594-2.7-4.476-2.7-1.883 0-3.598 1.035-4.476 2.702-.16.302-.502.46-.834.38H4.293z M12 8.545c-2.455 0-4.455 2-4.455 4.455s2 4.455 4.455 4.455 4.455-2 4.455-4.455-2-4.455-4.455-4.455zm0 7.41c-1.627 0-2.955-1.328-2.955-2.955s1.328-2.955 2.955-2.955 2.955 1.328 2.955 2.955-1.328 2.955-2.955 2.955z"></path></g>
                            </svg>
                        </div>
                    </label>
                </div>
            </div>
        </div>
    </div>
    
    <div class="p-4 pt-16">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
        
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Username</label>
                {{ user_form.username|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
            </div>
            
         
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Email</label>
                {{ user_form.email|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
            </div>
            
       ->
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">First Name</label>
                {{ user_form.first_name|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
            </div>
       >
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Last Name</label>
                {{ user_form.last_name|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
            </div>
            
  
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Bio</label>
                <div class="relative">
                    {{ profile_form.bio|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
                    <div class="absolute bottom-2 right-3 text-xs text-gray-500">
                        <span id="bio-counter">0</span>/160
                    </div>
                </div>
            </div>
         
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Location</label>
                {{ profile_form.location|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
            </div>
        
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Website</label>
                {{ profile_form.website|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
            </div>
            
        
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Birth Date</label>
                {{ profile_form.birth_date|add_class:"w-full p-2 border border-gray-700 rounded bg-black text-white focus:border-blue-400 focus:ring-1 focus:ring-blue-400 focus:outline-none transition-colors" }}
            </div>
            
       
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Profile Image</label>
                <div class="flex items-center">
                    <img src="{{ user.profile.avatar.url }}" alt="{{ user.username }}" class="w-16 h-16 rounded-full mr-4 border border-gray-700">
                    <div class="relative">
                        {{ profile_form.avatar|add_class:"opacity-0 absolute inset-0 w-full h-full cursor-pointer z-10" }}
                        <button type="button" class="bg-transparent border border-gray-600 text-gray-300 hover:border-blue-400 hover:text-blue-400 py-2 px-4 rounded-full text-sm transition-colors">
                            Change avatar
                        </button>
                    </div>
                </div>
            </div>
            
     
            <div class="mb-4">
                <label class="block text-gray-400 mb-2">Cover Image</label>
                <div class="flex items-center">
                    <img src="{{ user.profile.cover_image.url }}" alt="Cover" class="h-16 w-32 object-cover mr-4 rounded border border-gray-700">
                    <div class="relative">
                        {{ profile_form.cover_image|add_class:"opacity-0 absolute inset-0 w-full h-full cursor-pointer z-10" }}
                        <button type="button" class="bg-transparent border border-gray-600 text-gray-300 hover:border-blue-400 hover:text-blue-400 py-2 px-4 rounded-full text-sm transition-colors">
                            Change header
                        </button>
                    </div>
                </div>
            </div>
            
         
            <div class="flex justify-end mt-6">
                <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors">
                    Save
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
   
        const bioInput = document.getElementById('{{ profile_form.bio.id_for_label }}');
        const bioCounter = document.getElementById('bio-counter');
        
        if (bioInput && bioCounter) {
            bioCounter.textContent = bioInput.value.length;
            
            bioInput.addEventListener('input', function() {
                bioCounter.textContent = this.value.length;
                if (this.value.length > 160) {
                    bioCounter.classList.add('text-red-500');
                } else {
                    bioCounter.classList.remove('text-red-500');
                }
            });
        }
    });
</script>
{% endblock %}